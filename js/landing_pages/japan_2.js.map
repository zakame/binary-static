{"version":3,"sources":["../../../src/javascript/landing_pages/japan_2.js"],"names":["window","onload","jpClient","location","urlForLanguage","toggleMobileMenu","initForm","recordAffiliateExposure","collapseNavbar","tabWithButtons","getClientCountry","onresize","checkWidth","document","querySelectorAll","forEach","el","addEventListener","e","preventDefault","scrollToSection","gclid","getParamValue","referrer","localStorage","setItem","commonOnload","navbarFixedTopEl","getElementsByClassName","classList","scrollY","onscroll","target_el","width","innerWidth","documentElement","clientWidth","body","target_href","getAttribute","substr","offset_top","getElementById","offsetTop","to","test","scrollTo","collapseMenu","id","signup_form","ws","wsConnect","email_sent","sendVerifyEmail","val","checkCountry","trimmed_email","trimEmail","wsSend","verify_email","type","verifySubmit","msg","response","JSON","parse","data","setValidationStyle","el_email","error","querySelector","add","remove","str","replace","clients_country","sessionStorage","getItem","connect","onmessage","onclose","validation_set","handleSubmit","el_form","validateEmail","value","evt","readyState","onopen","email","form","element","has_error","error_class","invisible_class","length","el_tab_container","el_content_container","el_content_wrapper","el_contents","num_of_items","current_index","navs","parent","ul","createElement","idx","li","createLIElement","appendChild","btn_prev","setAttribute","updateTabContent","btn_next","touch_swipe","Hammer","on","ev","index","target_index","direction","getBoundingClientRect","mod","active_index","updateActiveContent","updateActiveNav","offset","style","left","i","accounts","Object","keys","some","loginid","residence","setSession","sendRequests","website_status","time"],"mappings":"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","file":"japan_2.js","sourcesContent":["/* global setSession:true */\n/* global urlForLanguage:true */\n/* global getLanguage:true */\n/* global jpClient:true */\n/* global recordAffiliateExposure:true */\n/* global Hammer */\n\nwindow.onload = function () {\n    if (!jpClient()) {\n        window.location = urlForLanguage('ja');\n    }\n\n    toggleMobileMenu();\n    initForm('email_top');\n    initForm('email_bottom');\n    recordAffiliateExposure();\n    collapseNavbar();\n    tabWithButtons();\n    getClientCountry();\n\n    window.onresize = checkWidth;\n\n    document.querySelectorAll('.page-scroll').forEach((el) => {\n        el.addEventListener('click', function(e) {\n            e.preventDefault();\n            scrollToSection(this);\n        });\n    });\n\n    // Store gclid\n    const gclid = getParamValue(document.referrer, 'gclid');\n    if (gclid) {\n        localStorage.setItem('gclid', gclid);\n    }\n\n    commonOnload();\n\n    // Collapse navbar on scroll\n    function collapseNavbar() {\n        const navbarFixedTopEl = document.getElementsByClassName('navbar-fixed-top');\n        navbarFixedTopEl[0].classList[window.scrollY < 50 ? 'add' : 'remove']('top-nav-collapse');\n    }\n\n    window.onscroll = collapseNavbar;\n};\n\nfunction scrollToSection(target_el) {\n    const width = window.innerWidth\n                  || document.documentElement.clientWidth\n                  || document.body.clientWidth;\n    const target_href = target_el.getAttribute('href').substr(1);\n    const offset_top = document.getElementById(target_href).offsetTop;\n\n    let to = offset_top - 50;\n\n    if (/^key-plus|^academy/i.test(target_href)) {\n        to = offset_top - 110;\n    }\n\n    if (width > 1199) { // for slanted pseudo element padding\n        to = offset_top - 100;\n        if (/^key-plus|^academy/i.test(target_href)) {\n            to = offset_top - 100;\n        }\n    }\n\n    scrollTo(to, 500);\n    collapseMenu();\n}\n\nfunction initForm(id) {\n    const signup_form = document.getElementById(id);\n\n    if (!signup_form) {\n        return;\n    }\n    let ws = wsConnect();\n    let email_sent = false;\n\n    function sendVerifyEmail(val) {\n        if (!checkCountry(val)) {\n            return;\n        }\n        const trimmed_email = trimEmail(val);\n        wsSend(ws, {\n            verify_email: trimmed_email,\n            type        : 'account_opening',\n        });\n    }\n\n    function verifySubmit(msg) {\n        const response = JSON.parse(msg.data);\n        setValidationStyle(signup_form, el_email, response.error);\n        if (!response.error) {\n            document.querySelectorAll('.signup-form').forEach((el) => {\n                el.querySelector('.signup-form-input').classList.add('invisible');\n                el.querySelector('.signup-form-success').classList.remove('invisible');\n                email_sent = true;\n            });\n        }\n    }\n\n    function trimEmail(str) {\n        return str.replace(/\\s/g, '');\n    }\n\n    function checkCountry(val) {\n        const clients_country = sessionStorage.getItem('clients_country');\n        if ((clients_country !== 'my') || /@binary\\.com$/.test(val)) {\n            return true;\n        }\n        document.querySelectorAll('.signup-form').forEach((el) => {\n            el.querySelector('.signup-form-input').classList.add('invisible');\n            el.querySelector('.signup-form-error').classList.remove('invisible');\n        });\n        return false;\n    }\n\n    function connect() {\n        if (email_sent) return;\n        ws = wsConnect();\n        ws.onmessage = verifySubmit;\n        ws.onclose = connect;\n    }\n\n    let validation_set = false; // To prevent validating before submit\n\n    signup_form.addEventListener('submit', handleSubmit);\n\n    let el_email;\n    function handleSubmit(e) {\n        e.preventDefault();\n\n        const el_form  = this;\n        el_email = el_form.querySelector('input[type=\"email\"]');\n        if (!validateEmail(trimEmail(el_email.value))) {\n            if (!validation_set) {\n                ['input', 'change'].forEach((evt) => {\n                    el_email.addEventListener(evt, () => {\n                        setValidationStyle(signup_form, el_email, !validateEmail(trimEmail(el_email.value)));\n                    });\n                });\n                setValidationStyle(signup_form, el_email, !validateEmail(trimEmail(el_email.value)));\n                validation_set = true;\n            }\n\n            const to = this.offsetTop - 100;\n            scrollTo(to, 500); // Scroll to nearest form\n            return;\n        }\n\n        if (ws.readyState === 1) {\n            sendVerifyEmail(el_email.value);\n        } else {\n            ws.onopen = sendVerifyEmail(el_email.value);\n        }\n    }\n\n    ws.onmessage = verifySubmit;\n    ws.onclose = connect;\n}\n\nfunction validateEmail(email) {\n    return /^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,63}$/.test(email);\n}\n\nfunction setValidationStyle(form, element, has_error) {\n    const error_class = 'error-field';\n    const invisible_class = 'invisible';\n\n    form.querySelectorAll('input[type=\"email\"]').forEach((el) => {\n        el.classList[has_error ? 'add' : 'remove'](error_class);\n    });\n\n    if (element.value.length < 1) {\n        form.querySelectorAll('.error_no_email').forEach((el) => {\n            el.classList[has_error ? 'remove' : 'add'](invisible_class);\n        });\n        form.querySelectorAll('.error_validate_email').forEach((el) => {\n            el.classList[has_error ? 'add' : 'remove'](invisible_class);\n        });\n    }\n    else if (element.value.length >= 1) {\n        form.querySelectorAll('.error_validate_email').forEach((el) => {\n            el.classList[has_error ? 'remove' : 'add'](invisible_class);\n        });\n        form.querySelectorAll('.error_no_email').forEach((el) => {\n            el.classList[has_error ? 'add' : 'remove'](invisible_class);\n        });\n    }\n    if (!has_error) {\n        form.querySelectorAll('.error_validate_email').forEach((el) => {\n            el.classList.add(invisible_class);\n        });\n        form.querySelectorAll('.error_no_email').forEach((el) => {\n            el.classList.add(invisible_class);\n        });\n    }\n}\n\nfunction tabWithButtons(id) {\n    const el_tab_container     = document.getElementById(id) ? document.getElementById(id) : document.body;\n    const el_content_container = el_tab_container.getElementsByClassName('twb-content-container')[0];\n    const el_content_wrapper   = el_tab_container.getElementsByClassName('twb-content-wrapper')[0];\n    const el_contents          = el_tab_container.querySelectorAll('div.twb-content');\n    const num_of_items = el_contents.length;\n    let current_index  = 0;\n    let navs;\n\n    (() => {\n        const parent = el_tab_container.querySelector('.twb-buttons');\n        const ul = document.createElement('ul');\n        for (let idx = 0; idx < num_of_items; idx++) {\n            const li = createLIElement(idx);\n            ul.appendChild(li);\n        }\n\n        const btn_prev = document.createElement('a');\n        btn_prev.classList.add('twb-button', 'twb-button-prev');\n        btn_prev.setAttribute('href', 'javascript:;');\n        btn_prev.addEventListener('click', (e) => {\n            e.preventDefault();\n            updateTabContent(--current_index);\n        });\n\n        const btn_next = document.createElement('a');\n        btn_next.classList.add('twb-button', 'twb-button-next');\n        btn_next.setAttribute('href', 'javascript:;');\n        btn_next.addEventListener('click', (e) => {\n            e.preventDefault();\n            updateTabContent(++current_index);\n        });\n\n        parent.appendChild(btn_prev);\n        parent.appendChild(ul);\n        parent.appendChild(btn_next);\n\n        navs = ul.querySelectorAll('li');\n\n        window.addEventListener('resize', () => {\n            updateTabContent(current_index);\n        });\n\n        const touch_swipe = new Hammer(el_content_wrapper);\n\n        touch_swipe.on('swipeleft swiperight tap press', (ev) => {\n            if (ev.type === 'swipeleft') {\n                updateTabContent(++current_index);\n            }\n            if (ev.type === 'swiperight') {\n                updateTabContent(--current_index);\n            }\n        });\n\n        function createLIElement(index) {\n            const li = document.createElement('li');\n            li.classList[index ? 'remove' : 'add']('active');\n            li.addEventListener('click', (e) => {\n                e.preventDefault();\n                updateTabContent(index, false);\n                current_index = index;\n            });\n            return li;\n        }\n    })();\n\n    function updateTabContent(target_index, direction = true) {\n        const width = el_content_container.getBoundingClientRect().width;\n        const mod   = target_index % num_of_items;\n        let active_index;\n\n        if (direction) {\n            active_index = mod;\n            if (mod < 0) {\n                active_index = mod + num_of_items;\n            }\n        } else {\n            active_index = target_index;\n        }\n\n        updateActiveContent(active_index);\n        updateActiveNav(active_index);\n\n        function updateActiveContent(idx) {\n            const offset = idx * width;\n            el_content_container.style.left = `${((offset > 0 ? -offset : offset) % (num_of_items * width))}px`;\n        }\n        function updateActiveNav(idx) {\n            navs.forEach((el, i) => {\n                el.classList[idx === i ? 'add' : 'remove']('active');\n            });\n        }\n    }\n}\n\nfunction getClientCountry() {\n    let clients_country = sessionStorage.getItem('clients_country');\n\n    // Try to get residence from client's info if logged-in\n    if (!clients_country) {\n        const accounts = JSON.parse(localStorage.getItem('client.accounts') || null);\n        if (accounts) {\n            Object.keys(accounts).some((loginid) => {\n                if (accounts[loginid].residence) {\n                    clients_country = accounts[loginid].residence;\n                    setSession('clients_country', clients_country);\n                    return true;\n                }\n                return false;\n            });\n        }\n    }\n\n    // Get required info from WebSocket\n    const ws = wsConnect();\n\n    function sendRequests() {\n        if (!clients_country) wsSend(ws, { website_status: 1 });\n        wsSend(ws, { time: 1 });\n    }\n\n    if (ws.readyState === 1) {\n        sendRequests();\n    } else {\n        ws.onopen = sendRequests;\n    }\n\n    ws.onmessage = function (msg) {\n        const response = JSON.parse(msg.data);\n        if (response.website_status) {\n            clients_country = response.website_status.clients_country;\n            setSession('clients_country', clients_country);\n        }\n    };\n\n    return clients_country;\n}\n"]}